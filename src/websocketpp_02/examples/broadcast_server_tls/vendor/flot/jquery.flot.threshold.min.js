(function(b){var a={series:{threshold:null}};function c(d){function e(l,s,m){if(!s.threshold){return }var f=m.pointsize,i,o,n,g,k,h=b.extend({},s);h.datapoints={points:[],pointsize:f};h.label=null;h.color=s.threshold.color;h.threshold=null;h.originseries=s;h.data=[];var p=s.threshold.below,q=m.points,r=s.lines.show;threspoints=[];newpoints=[];for(i=0;i<q.length;i+=f){o=q[i];n=q[i+1];k=g;if(n<p){g=threspoints}else{g=newpoints}if(r&&k!=g&&o!=null&&i>0&&q[i-f]!=null){var j=(o-q[i-f])/(n-q[i-f+1])*(p-n)+o;k.push(j);k.push(p);for(m=2;m<f;++m){k.push(q[i+m])}g.push(null);g.push(null);for(m=2;m<f;++m){g.push(q[i+m])}g.push(j);g.push(p);for(m=2;m<f;++m){g.push(q[i+m])}}g.push(o);g.push(n)}m.points=newpoints;h.datapoints.points=threspoints;if(h.datapoints.points.length>0){l.getdata().push(h)}}d.hooks.processdatapoints.push(e)}b.plot.plugins.push({init:c,options:a,name:"threshold",version:"1.0"})})(jquery);